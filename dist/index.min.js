var MITO=function(){"use strict";var e,t,n=function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function r(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var a=arguments[t],i=0,s=a.length;i<s;i++,o++)r[o]=a[i];return r}!function(e){e.UNKNOWN="UNKNOWN",e.UNKNOWN_FUNCTION="UNKNOWN_FUNCTION",e.JAVASCRIPT_ERROR="JAVASCRIPT_ERROR",e.BUSINESS_ERROR="BUSINESS_ERROR",e.LOG_ERROR="LOG_ERROR",e.FETCH_ERROR="HTTP_ERROR",e.VUE_ERROR="VUE_ERROR",e.REACT_ERROR="REACT_ERROR",e.RESOURCE_ERROR="RESOURCE_ERROR",e.PROMISE_ERROR="PROMISE_ERROR"}(e||(e={})),function(e){e.OnLaunch="onLaunch",e.OnShow="onShow",e.OnHide="onHide",e.OnError="onError",e.OnPageNotFound="onPageNotFound",e.OnUnhandledRejection="onUnhandledRejection",e.Console="wxConsole"}(t||(t={}));var o,a,i,s,c;n(n({},t),e);!function(e){e.ROUTE="Route",e.CLICK="UI.Click",e.CONSOLE="Console",e.XHR="Xhr",e.FETCH="Fetch",e.UNHANDLEDREJECTION="Unhandledrejection",e.VUE="Vue",e.REACT="React",e.RESOURCE="Resource",e.CODE_ERROR="Code Error",e.CUSTOMER="Customer",e.ON_SHOW="On Show",e.ON_LAUNCH="On Launch"}(o||(o={})),function(e){e.HTTP="http",e.USER="user",e.DEBUG="debug",e.EXCEPTION="exception",e.LIFECYCLE="lifecycle"}(a||(a={})),function(e){e.XHR="xhr",e.FETCH="fetch",e.CONSOLE="console",e.DOM="dom",e.HISTORY="history",e.ERROR="error",e.HASHCHANGE="hashchange",e.UNHANDLEDREJECTION="unhandledrejection",e.MITO="mito",e.VUE="Vue"}(i||(i={})),function(e){e.XHR="xhr",e.FETCH="fetch"}(s||(s={})),function(e){e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.INTERNAL_EXCEPTION=500]="INTERNAL_EXCEPTION"}(c||(c={}));var u=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/,l={isLogAddBreadcrumb:!0,crossOriginThreshold:1e3},p=Object.prototype.toString;function f(e){return function(t){return Object.prototype.toString.call(t)==="[object "+e+"]"}}var d={isNumber:f("Number"),isString:f("String"),isBoolean:f("Boolean"),isNull:f("Null"),isUndefined:f("Undefined"),isSymbol:f("Symbol"),isFunction:f("Function"),isObject:f("Object"),isArray:f("Array"),isProcess:f("process"),isWindow:f("Window")};function h(e){switch(p.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return function(e,t){try{return e instanceof t}catch(e){return!1}}(e,Error)}}function E(e){return"[object String]"===p.call(e)}var R=d.isProcess("undefined"!=typeof process?process:0),g=d.isObject("undefined"!=typeof wx?wx:0)&&d.isFunction("undefined"!=typeof App?App:0),m=d.isWindow("undefined"!=typeof window?window:0);var O=m?window:g?wx:R?process:void 0,y=(O.__MITO__=O.__MITO__||{},O.__MITO__);y.replaceFlag=y.replaceFlag||{};var v=y.replaceFlag;function b(e,t){v[e]||(v[e]=t)}function N(e){return!!v[e]}var T="MITO Logger",C=function(){function e(){var e=this;if(this.enabled=!1,this._console={},O.console){["log","debug","info","warn","error","assert"].forEach((function(t){t in O.console&&(e._console[t]=O.console[t])}))}}return e.prototype.disable=function(){this.enabled=!1},e.prototype.bindOptions=function(e){this.enabled=!!e},e.prototype.enable=function(){this.enabled=!0},e.prototype.log=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.enabled&&(e=this._console).log.apply(e,r([T+"[Log]:"],t))},e.prototype.warn=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.enabled&&(e=this._console).warn.apply(e,r([T+"[Warn]:"],t))},e.prototype.error=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.enabled&&(e=this._console).error.apply(e,r([T+"[Error]:"],t))},e}(),U=y.logger||(y.logger=new C);function S(){return"undefined"==typeof document||null==document.location?"":document.location.href}function x(e,t,n,r){void 0===r&&(r=!1),e.addEventListener(t,n,r)}function I(e,t,n,r){if(void 0===r&&(r=!1),t in e||r){var o=n(e[t]);"function"==typeof o&&(e[t]=o)}}function _(){return Date.now()}function H(e,t){return typeof e===t}function k(e,t,n){return!!H(e,n)||(void 0!==e&&U.error(t+"期望传入"+n+"类型，目前是"+typeof e+"类型"),!1)}function A(e,t,n){return!!function(e,t){return Object.prototype.toString.call(e)===t}(e,n)||(void 0!==e&&U.error(t+"期望传入"+n+"类型，目前是"+typeof e+"类型"),!1)}function D(e){l.isLogAddBreadcrumb=!1,e(),l.isLogAddBreadcrumb=!0}function w(e){return H(e,"string")?e:JSON.stringify(e)}function L(e){return Number(e.split(".")[0])}function P(e){if(!e)return{};var t=e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};var n=t[6]||"",r=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],relative:t[5]+n+r}}function F(t,r){var o={time:_(),url:S(),name:t.name,level:r,message:t.message};if(void 0===t.stack||!t.stack)return o;for(var a,i,s,c=/^\s*at (.*?) ?\(((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|[a-z]:|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,u=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|\[native).*?|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i,l=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,p=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,f=/\((\S*)(?::(\d+))(?::(\d+))\)/,d=t.stack.split("\n"),h=[],E=0,R=d.length;E<R;++E){if(i=c.exec(d[E])){var g=i[2]&&0===i[2].indexOf("native");i[2]&&0===i[2].indexOf("eval")&&(a=f.exec(i[2]))&&(i[2]=a[1],i[3]=a[2],i[4]=a[3]),s={url:g?null:i[2],func:i[1]||e.UNKNOWN_FUNCTION,args:g?[i[2]]:[],line:i[3]?+i[3]:null,column:i[4]?+i[4]:null}}else if(i=l.exec(d[E]))s={url:i[2],func:i[1]||e.UNKNOWN_FUNCTION,args:[],line:+i[3],column:i[4]?+i[4]:null};else{if(!(i=u.exec(d[E])))continue;i[3]&&i[3].indexOf(" > eval")>-1&&(a=p.exec(i[3]))?(i[3]=a[1],i[4]=a[2],i[5]=null):0!==E||i[5]||void 0===t.columnNumber||(h[0].column=t.columnNumber+1),s={url:i[3],func:i[1]||e.UNKNOWN_FUNCTION,args:i[2]?i[2].split(","):[],line:i[4]?+i[4]:null,column:i[5]?+i[5]:null}}!s.func&&s.line&&(s.func=e.UNKNOWN_FUNCTION),h.push(s)}return h.length?n(n({},o),{stack:h}):null}var j=function(){function e(){this.stack=[],this.isFlushing=!1,"Promise"in O&&(this.micro=Promise.resolve())}return e.prototype.addFn=function(e){var t=this;"function"==typeof e&&("Promise"in O?(this.stack.push(e),this.isFlushing||(this.isFlushing=!0,this.micro.then((function(){return t.flushStack()})))):e())},e.prototype.getStack=function(){return this.stack},e.prototype.flushStack=function(){var e=this.stack.slice(0);this.stack.length=0,this.isFlushing=!1;for(var t=0;t<e.length;t++)e[t]()},e}(),X=function(){function e(){this.maxBreadcrumbs=10,this.beforePushBreadcrumb=null,this.stack=[]}return e.prototype.push=function(e){var t=this;if("function"!=typeof this.beforePushBreadcrumb)this.immediatePush(e);else{var n=null,r=this.beforePushBreadcrumb;if(D((function(){n=r(t,e)})),!n)return;this.immediatePush(n)}},e.prototype.immediatePush=function(e){e.time=_(),this.stack.length>=this.maxBreadcrumbs&&this.shift(),this.stack.push(e),U.log(this.stack)},e.prototype.shift=function(){return void 0!==this.stack.shift()},e.prototype.clear=function(){this.stack=[]},e.prototype.getStack=function(){return this.stack},e.prototype.getCategory=function(e){switch(e){case o.XHR:case o.FETCH:return a.HTTP;case o.CLICK:case o.ROUTE:return a.USER;case o.CUSTOMER:case o.CONSOLE:return a.DEBUG;case o.ON_LAUNCH:case o.ON_SHOW:return a.LIFECYCLE;case o.UNHANDLEDREJECTION:case o.CODE_ERROR:case o.RESOURCE:case o.VUE:case o.REACT:default:return a.EXCEPTION}},e.prototype.bindOptions=function(e){void 0===e&&(e={});var t=e.maxBreadcrumbs,n=e.beforePushBreadcrumb;k(t,"maxBreadcrumbs","number")&&(this.maxBreadcrumbs=t),k(n,"beforePushBreadcrumb","function")&&(this.beforePushBreadcrumb=n)},e}(),M=y.breadcrumb||(y.breadcrumb=new X),B={};function $(t){var n,r=J(t.url.replace(/(\S+)(\/#\/)(\S*)/,"$1").replace(/(\S*)(\/\/)(\S+)/,"$3"));switch(t.type){case e.FETCH_ERROR:n=t.type+t.request.method+t.response.status+J(t.request.url)+r;break;case e.JAVASCRIPT_ERROR:case e.VUE_ERROR:case e.REACT_ERROR:n=t.type+t.name+t.message+r;break;case e.BUSINESS_ERROR:case e.LOG_ERROR:n=t.customTag+t.type+t.name+r;break;case e.PROMISE_ERROR:n=function(e,t){var n=J(e.url);if(e.name===i.UNHANDLEDREJECTION)return e.type+V(e.message)+t;return e.type+e.name+V(e.message)+n}(t,r);break;default:n=t.type+t.message+r}return n=function(e){var t=0;if(0==e.length)return t;for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);t=(t<<5)-t+r,t&=t}return t}(n),B[n]>1?null:("number"==typeof B[n]?B[n]++:B[n]=1,n)}function V(e){var t=function(e){return Object.keys(e).sort().reduce((function(n,r){return"[object Object]"===Object.prototype.toString.call(e[r])?n[r]=t(e[r]):n[r]=e[r],n}),{})};try{if(/\{.*\}/.test(e)){var n=JSON.parse(e);return n=t(n),JSON.stringify(n)}}catch(t){return e}}function J(e){return e.replace(/[\?#].*$/,"").replace(/\/\d+([\/]*$)/,"{param}$1")}var W;!function(e){e.Get="GET",e.Post="POST",e.Put="PUT",e.Delete="DELETE"}(W||(W={}));var q,K,G=function(){function e(e){this.url=e,this.beforeDataReport=null,this.backTrackerId=null,this.configReportXhr=null,this.apikey="",this.queue=new j}return e.prototype.getRecord=function(){var e,t=y.record;return t&&(e=t,"[object Array]"===p.call(e))&&t.length>2?t:[]},e.prototype.beforePost=function(e){if("function"==typeof this.beforeDataReport&&!(e=this.beforeDataReport(e)))return!1;var t=$(e);return!!t&&(e.errorId=t,JSON.stringify(this.getTransportData(e)))},e.prototype.xhrPost=function(e){var t=this,n=this.beforePost(e);if(n){this.queue.addFn((function(){var e=new XMLHttpRequest;e.open(W.Post,t.url),e.setRequestHeader("Content-Type","application/json;charset=UTF-8"),e.withCredentials=!0,"function"==typeof t.configReportXhr&&t.configReportXhr(e),e.send(n)}))}},e.prototype.wxPost=function(e){var t=this,n=this.beforePost(e);if(n){this.queue.addFn((function(){wx.request({method:"POST",header:{"Content-Type":"application/json;charset=UTF-8"},url:t.url,data:n})}))}},e.prototype.getAuthInfo=function(){var e=this.getTrackerId();return{trackerId:String(e),sdkVersion:"1.2.2",sdkName:"@zyf2e/mitojs",apikey:this.apikey}},e.prototype.getTrackerId=function(){if("function"==typeof this.backTrackerId){var e=this.backTrackerId();if("string"==typeof e||"number"==typeof e)return e;U.error("trackerId:"+e+" 期望 string 或 number 类型，但是传入 "+typeof e)}return""},e.prototype.getTransportData=function(e){return{authInfo:this.getAuthInfo(),breadcrumb:M.getStack(),data:e,record:this.getRecord()}},e.prototype.isSdkTransportUrl=function(e){return-1!==e.indexOf(this.url)},e.prototype.bindOptions=function(e){void 0===e&&(e={});var t=e.dsn,n=e.beforeDataReport,r=e.apikey,o=e.configReportXhr,a=e.backTrackerId;k(r,"apikey","string")&&(this.apikey=r),k(t,"dsn","string")&&(this.url=t),k(n,"beforeDataReport","function")&&(this.beforeDataReport=n),k(o,"configReportXhr","function")&&(this.configReportXhr=o),k(a,"backTrackerId","function")&&(this.backTrackerId=a)},e.prototype.send=function(e){return m?this.xhrPost(e):g?this.wxPost(e):void 0},e}(),Y=y.transportData||(y.transportData=new G("//localhost:3000/api/error/upload"));function Z(t){var n="",r=t.elapsedTime,o=t.time,a=t.method,i=t.traceId,s=t.type,c=t.status;return n=0===c?r<=l.crossOriginThreshold?"http请求失败，失败原因：跨域限制或域名不存在":"http请求失败，失败原因：超时":function(e){if(e<400)return K.Ok;if(e>=400&&e<500)switch(e){case 401:return K.Unauthenticated;case 403:return K.PermissionDenied;case 404:return K.NotFound;case 409:return K.AlreadyExists;case 413:return K.FailedPrecondition;case 429:return K.ResourceExhausted;default:return K.InvalidArgument}if(e>=500&&e<600)switch(e){case 501:return K.Unimplemented;case 503:return K.Unavailable;case 504:return K.DeadlineExceeded;default:return K.InternalError}return K.UnknownError}(c),{type:e.FETCH_ERROR,url:S(),time:o,elapsedTime:r,level:q.Low,message:n,name:s+"--"+a,request:{httpType:s,traceId:i,method:a,url:t.url,data:t.reqData||""},response:{status:c,data:t.responseText}}}!function(e){e.Else="else",e.Error="error",e.Warning="warning",e.Info="info",e.Debug="debug",e.Low="low",e.Normal="normal",e.High="high",e.Critical="critical"}(q||(q={})),function(e){e.fromString=function(t){switch(t){case"debug":return e.Debug;case"info":case"log":case"assert":return e.Info;case"warn":case"warning":return e.Warning;case e.Low:case e.Normal:case e.High:case e.Critical:case"error":return e.Error;default:return e.Else}}}(q||(q={})),function(e){e.Ok="ok",e.DeadlineExceeded="deadline_exceeded",e.Unauthenticated="unauthenticated",e.PermissionDenied="permission_denied",e.NotFound="not_found",e.ResourceExhausted="resource_exhausted",e.InvalidArgument="invalid_argument",e.Unimplemented="unimplemented",e.Unavailable="unavailable",e.InternalError="internal_error",e.UnknownError="unknown_error",e.Cancelled="cancelled",e.AlreadyExists="already_exists",e.FailedPrecondition="failed_precondition",e.Aborted="aborted",e.OutOfRange="out_of_range",e.DataLoss="data_loss"}(K||(K={}));var z={img:"图片",script:"js脚本"};var Q=function(){function e(){this.traceIdFieldName="Trace-Id",this.enableTraceId=!1}return e.prototype.bindOptions=function(e){void 0===e&&(e={});var t=e.beforeAppAjaxSend,n=e.enableTraceId,r=e.filterXhrUrlRegExp,o=e.traceIdFieldName,a=e.includeHttpUrlTraceIdRegExp;k(t,"beforeAppAjaxSend","function")&&(this.beforeAppAjaxSend=t),k(n,"enableTraceId","boolean")&&(this.enableTraceId=n),k(o,"traceIdFieldName","string")&&(this.traceIdFieldName=o),A(r,"filterXhrUrlRegExp","[object RegExp]")&&(this.filterXhrUrlRegExp=r),A(a,"includeHttpUrlTraceIdRegExp","[object RegExp]")&&(this.includeHttpUrlTraceIdRegExp=a)},e}(),ee=y.options||(y.options=new Q);function te(e,t){var n,r=ee.includeHttpUrlTraceIdRegExp;if(ee.enableTraceId&&r&&r.test(e)){var o=(n=(new Date).getTime(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==e?t:3&t|8).toString(16)})));t(ee.traceIdFieldName,o)}}function ne(t,r,a,i,s,c){var u=null==c?void 0:c.version,l={type:e.VUE_ERROR,message:t.message+"("+a+")",level:i,url:S(),name:t.name,stack:t.stack||[],time:_()};if(d.isString(u))switch(console.log("getBigVersion",L(u)),L(u)){case 2:l=n(n({},l),function(e){var t="";if(e.$root===e)t="root";else{var n=e._isVue?e.$options&&e.$options.name||e.$options&&e.$options._componentTag:e.name;t=(n?"component <"+n+">":"anonymous component")+(e._isVue&&e.$options&&e.$options.__file?" at "+(e.$options&&e.$options.__file):"")}return{componentName:t,propsData:e.$options&&e.$options.propsData}}(r));break;case 3:l=n(n({},l),function(e){var t="";if(e.$root===e)t="root";else{console.log(e.$options);var n=e.$options&&e.$options.name;t=n?"component <"+n+">":"anonymous component"}return{componentName:t,propsData:e.$props}}(r));break;default:return}M.push({type:o.VUE,category:M.getCategory(o.VUE),data:l,level:s}),Y.send(l)}var re="undefined"!=typeof console,oe={install:function(e){!N(i.VUE)&&e&&e.config&&(b(i.VUE,!0),e.config.errorHandler=function(t,n,r){ne.apply(null,[t,n,r,q.Normal,q.Error,e]),re&&!e.config.silent&&D((function(){console.error("Error in "+r+': "'+t.toString()+'"',n),console.error(t)}))})}},ae={handleHttp:function(e,t){var n=0===e.status||e.status===c.BAD_REQUEST||e.status>c.UNAUTHORIZED,r=Z(e);M.push({type:t,category:M.getCategory(t),data:r,level:q.Info}),n&&(M.push({type:t,category:M.getCategory(o.CODE_ERROR),data:r,level:q.Error}),Y.send(r))},handleError:function(t){if(t.target.localName){var n=function(t){return{type:e.RESOURCE_ERROR,url:S(),message:"资源地址: "+(t.src.slice(0,100)||t.href.slice(0,100)),level:q.Low,time:_(),name:(z[t.localName]||t.localName)+"加载失败"}}(t.target);return M.push({type:o.RESOURCE,category:M.getCategory(o.RESOURCE),data:n,level:q.Error}),Y.send(n)}var r,a=t.message,i=t.filename,s=t.lineno,c=t.colno,u=t.error;u&&h(u)&&(r=F(u,q.Normal)),r||(r=ae.handleNotErrorInstance(a,i,s,c)),r.type=e.JAVASCRIPT_ERROR,M.push({type:o.CODE_ERROR,category:M.getCategory(o.CODE_ERROR),data:r,level:q.Error}),Y.send(r)},handleNotErrorInstance:function(t,n,r,o){var a=e.UNKNOWN,i=n||S(),s=t,c=t.match(u);c[1]&&(a=c[1],s=c[2]);var l={url:i,func:e.UNKNOWN_FUNCTION,args:e.UNKNOWN,line:r,col:o};return{url:i,name:a,message:s,level:q.Normal,time:_(),stack:[l]}},handleHistory:function(e){var t=e.from,n=e.to,r=P(t).relative,a=P(n).relative;M.push({type:o.ROUTE,category:M.getCategory(o.ROUTE),data:{from:r||"/",to:a||"/"},level:q.Info})},handleHashchange:function(e){var t=e.oldURL,n=e.newURL,r=P(t).relative,a=P(n).relative;M.push({type:o.ROUTE,category:M.getCategory(o.ROUTE),data:{from:r,to:a},level:q.Info})},handleUnhandleRejection:function(t){var r={type:e.PROMISE_ERROR,message:w(t.reason),url:S(),name:t.type,time:_(),level:q.Low};h(t.reason)&&(r=n(n({},r),F(t.reason,q.Low))),M.push({type:o.UNHANDLEDREJECTION,category:M.getCategory(o.UNHANDLEDREJECTION),data:r,level:q.Error}),Y.send(r)},handleConsole:function(e){l.isLogAddBreadcrumb&&M.push({type:o.CONSOLE,category:M.getCategory(o.CONSOLE),data:e,level:q.fromString(e.level)})}},ie={};function se(e,t){e&&ie[e]&&ie[e].forEach((function(n){!function(e,t){try{e()}catch(e){console.log("err",e),t&&t(e)}}((function(){n(t)}),(function(t){U.error("重写事件triggerHandlers的回调函数发生错误\nType:"+e+"\nName: "+function(e){try{return e&&"function"==typeof e&&e.name||"<anonymous>"}catch(e){return"<anonymous>"}}(n)+"\nError: "+t)}))}))}var ce,ue,le,pe,fe=(ce=se,ue=600,le=!0,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];le&&(ce.apply(this,e),le=!1,setTimeout((function(){le=!0}),ue))});function de(e){return ee.filterXhrUrlRegExp&&ee.filterXhrUrlRegExp.test(e)}function he(e){switch(e){case i.XHR:!function(){if(!("XMLHttpRequest"in O))return;var e=XMLHttpRequest.prototype;I(e,"open",(function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.mito_xhr={method:E(t[0])?t[0].toUpperCase():t[0],url:t[1],sTime:_(),type:s.XHR},e.apply(this,t)}})),I(e,"send",(function(e){return function(){for(var t=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=this.mito_xhr,a=o.method,s=o.url;te(s,(function(e,n){t.mito_xhr.traceId=n,t.setRequestHeader(e,n)})),ee.beforeAppAjaxSend&&ee.beforeAppAjaxSend({method:a,url:s},this),x(this,"loadend",(function(){if(!(a===W.Post&&Y.isSdkTransportUrl(s)||de(s))){var e=this.responseType,t=this.response,r=this.status;this.mito_xhr.reqData=n[0];var o=_();this.mito_xhr.time=o,this.mito_xhr.status=r,-1!==["","json","text"].indexOf(e)&&(this.mito_xhr.responseText="object"==typeof t?JSON.stringify(t):t),this.mito_xhr.elapsedTime=o-this.mito_xhr.sTime,se(i.XHR,this.mito_xhr)}})),e.apply(this,n)}}))}();break;case i.FETCH:!function(){if(!("fetch"in O))return;I(O,i.FETCH,(function(e){return function(t,r){void 0===r&&(r={});var o=_(),a=r&&r.method||"GET",u={type:s.FETCH,method:a,reqData:r&&r.body,url:t},l=new Headers(r.headers||{});return Object.assign(l,{setRequestHeader:l.set}),te(t,(function(e,t){u.traceId=t,l.set(e,t)})),ee.beforeAppAjaxSend&&ee.beforeAppAjaxSend({method:a,url:t},l),r=n(n({},r),{headers:l}),e.apply(O,[t,r]).then((function(e){var r=e.clone(),s=_();return u=n(n({},u),{elapsedTime:s-o,status:r.status,time:s}),r.text().then((function(e){a===W.Post&&Y.isSdkTransportUrl(t)||de(t)||(u.responseText=r.status>c.UNAUTHORIZED&&e,se(i.FETCH,u))})),e}),(function(e){var r=_();if(!(a===W.Post&&Y.isSdkTransportUrl(t)||de(t)))throw u=n(n({},u),{elapsedTime:r-o,status:0,time:r}),se(i.FETCH,u),e}))}}))}();break;case i.ERROR:x(O,"error",(function(e){se(i.ERROR,e)}),!0);break;case i.CONSOLE:!function(){if(!("console"in O))return;["log","debug","info","warn","error","assert"].forEach((function(e){e in O.console&&I(O.console,e,(function(t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];t&&(se(i.CONSOLE,{args:n,level:e}),t.apply(O.console,n))}}))}))}();break;case i.HISTORY:!function(){if(e=O,t=e.chrome,n=t&&t.app&&t.app.runtime,r="history"in e&&!!e.history.pushState&&!!e.history.replaceState,n||!r)return;var e,t,n,r;var o=O.onpopstate;function a(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t.length>2?t[2]:void 0;if(r){var o=pe,a=String(r);pe=a,se(i.HISTORY,{from:o,to:a})}return e.apply(this,t)}}O.onpopstate=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=S(),r=pe;se(i.HISTORY,{from:r,to:n}),o&&o.apply(this,e)},I(O.history,"pushState",a),I(O.history,"replaceState",a)}();break;case i.UNHANDLEDREJECTION:x(O,i.UNHANDLEDREJECTION,(function(e){se(i.UNHANDLEDREJECTION,e)}));break;case i.DOM:!function(){if(!("document"in O))return;x(O.document,"click",(function(){fe(i.DOM,{category:"click",data:this})}),!0)}();break;case i.HASHCHANGE:t="onpopstate",O.hasOwnProperty(t)||x(O,i.HASHCHANGE,(function(e){se(i.HASHCHANGE,e)}))}var t}function Ee(e){!function(e){e&&(N(e.type)||(b(e.type,!0),ie[e.type]=ie[e.type]||[],ie[e.type].push(e.callback)))}(e),he(e.type)}function Re(e){var t;void 0===e&&(e={}),void 0===(t=e)&&(t={}),b(i.XHR,!!t.silentXhr),b(i.FETCH,!!t.silentFetch),b(i.CONSOLE,!!t.silentConsole),b(i.DOM,!!t.silentDom),b(i.HISTORY,!!t.silentHistory),b(i.ERROR,!!t.silentError),b(i.HASHCHANGE,!!t.silentHashchange),b(i.UNHANDLEDREJECTION,!!t.silentUnhandledrejection),b(i.VUE,!!t.silentVue),M.bindOptions(e),U.bindOptions(e.debug),Y.bindOptions(e),ee.bindOptions(e)}return pe=S(),{MitoVue:oe,SDK_VERSION:"1.2.2",SDK_NAME:"@zyf2e/mitojs",init:function(e){void 0===e&&(e={}),"XMLHttpRequest"in O&&!e.disabled&&(Re(e),Ee({callback:function(e){ae.handleHttp(e,o.XHR)},type:i.XHR}),Ee({callback:function(e){ae.handleHttp(e,o.FETCH)},type:i.FETCH}),Ee({callback:function(e){ae.handleError(e)},type:i.ERROR}),Ee({callback:function(e){ae.handleConsole(e)},type:i.CONSOLE}),Ee({callback:function(e){ae.handleHistory(e)},type:i.HISTORY}),Ee({callback:function(e){ae.handleUnhandleRejection(e)},type:i.UNHANDLEDREJECTION}),Ee({callback:function(e){var t=function(e){var t=e.tagName.toLowerCase();if("body"===t)return null;var n=e.classList.value;return n=""!==n?' class="'+n+'"':"","<"+t+(e.id?' id="'+e.id+'"':"")+(""!==n?n:"")+">"+e.innerText+"</"+t+">"}(e.data.activeElement);t&&M.push({type:o.CLICK,category:M.getCategory(o.CLICK),data:t,level:q.Info})},type:i.DOM}),Ee({callback:function(e){ae.handleHashchange(e)},type:i.HASHCHANGE}))},log:function(t){var r=t.message,a=void 0===r?"emptyMsg":r,i=t.tag,s=void 0===i?"":i,c=t.level,u=void 0===c?q.Critical:c,l=t.ex,p=void 0===l?"":l,f={};h(p)&&(f=F(p,u));var d=n({type:e.LOG_ERROR,level:u,message:w(a),name:"MITO.log",customTag:w(s),time:_(),url:S()},f);M.push({type:o.CUSTOMER,category:M.getCategory(o.CUSTOMER),data:a,level:q.fromString(u.toString())}),Y.send(d)},errorBoundaryReport:function(t){if(h(t)){var n=F(t,q.Normal);n.type=e.REACT_ERROR,M.push({type:o.REACT,category:M.getCategory(o.REACT),data:n.name+": "+n.message,level:q.fromString(n.level)}),Y.send(n)}else console.warn("传入的react error不是一个object Error")}}}();
