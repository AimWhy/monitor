<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>native-js-demo</title>
  <script src="../../dist/index.min.js"></script>
  <script>
  </script>
</head>
<body>
      <script src="./initMito.js"></script>
      <h1>native-js:控制台输出信息调试</h1>
      <button onclick="codeError()">代码错误</button>
      <button onclick="onClickFetchNormal()">正常请求</button>
      <button onclick="onClickFetchError()">异常请求</button>
      <button onclick="onClickNativeFetch()">Fetch请求</button>
      <button onclick="mitoLog()">log上报</button>
      <button onclick="testPromise()">testPromise</button>
      <a href="/Vue/index.html">跳到Vue页面</a>
      <button onclick="testPromise()">testPromise</button>
      <script>
        function codeError() {
         let a = {}
         a.split('/')
        }
        function testPromise() {
          new Promise((resolve, reject) => {
            reject('test')
            // let a = 1
            // a.split('')
          })
        }
        function mitoLog() {
          // MITO.log({message: {one:111}, tag: '测试', level:3})
          // 兼容老代码
          // MITO.log('错误', {one:11})
        }
        function onClickNativeFetch() {
          fetch('https://api.apiopen.top/likePoetry?name=李白').then(res => {
            res.text().then(res => {
          })
          },err => {
            console.log('err', err.name, err.message)
          })
        }
        function onClickFetchNormal() {
            const xhr = new XMLHttpRequest()
            xhr.open('get', 'https://api.apiopen.top/likePoetry?name=李白')
            xhr.setRequestHeader('content-type', 'application/json')
            xhr.send()
            xhr.onreadystatechange = function () {
              if (xhr.readyState === 4) {
                console.log(xhr)
                console.log('responseType', xhr.responseType)
                console.log(xhr.responseText)
              }
            }
        }
        function onClickFetchError() {
            const xhr = new XMLHttpRequest()
            xhr.open('get', 'http://asdas.aaa/info2')
            xhr.setRequestHeader('content-type', 'application/json')
            xhr.send()
            xhr.onreadystatechange = function () {
              if (xhr.readyState === 4) {
                console.log(xhr.responseText)
              }
            }
        }
      </script>
</body>
</html>
